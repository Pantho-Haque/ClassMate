<!DOCTYPE html> <html> <head> <script src="https://use.fontawesome.com/b4f1ce8a81.js"></script> <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"> <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <script src="https://code.jquery.com/jquery-3.1.1.min.js" crossorigin="anonymous"></script> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css"> <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script> <link rel="stylesheet" href="styling/form.css"> <link rel="icon" href="resources/ClassMatelogo.png" type="image/icon type"> <title>ClassMate</title> </head> <body> <main id="main"> <div id="brand"> <img id="brangimg" src="resources/ClassMatelogo.png" alt="logo"> <p id="brandname">ClassMate</p> </div> <div id="cbox"> <div class="row"> <h3 class="dec">Creating Class</h3> <form class="col s12"> <div class="row"> <div class="input-field col s6"> <input id="ins" type="text" class="validate"> <label for="ins">Institute *</label> </div> <div class="input-field col s6"> <input id="sins" type="text" class="validate"> <label for="sins">Institute Short Name *</label> </div> </div> <div class="row"> <div class="input-field col s6"> <input id="dep" type="text" class="validate"> <label for="dep">Department/Class *</label> </div> <div class="input-field col s6"> <input id="year" type="text" class="validate"> <label for="year">Batch *</label> </div> </div> <div class="row"> <div class="input-field col s12"> <input id="ts" type="number" class="validate"> <label for="ts">Total Students *</label> </div> </div> <div class="row"> <div class="input-field col s6"> <input id="fr" type="text" class="validate"> <label for="fr">First Roll *</label> </div> <div class="input-field col s6"> <input id="lr" type="text" class="validate"> <label for="lr">Last Roll *</label> </div> </div> <div class="row"> <div class="input-field col s12"> <input id="ncr" type="number" class="validate"> <label for="ncr">Number of Class Representative(CR) *</label> </div> </div> <div class="row"> <div class="input-field col s12"> <input id="crr" type="text" class="validate"> <label for="crr">Roll of CR[separate with comma(,)] *</label> </div> </div> </form> </div> <div class="allbtns"> <img src="resources/Spinner.gif" alt="Wait" width="60vw"> <a id="continuebtn" class="waves-effect waves-light btn-small bnt cclass">Continue</a> </div> </div> </main> <script src="https://www.gstatic.com/firebasejs/8.2.4/firebase-app.js"></script> <script src="https://www.gstatic.com/firebasejs/8.2.4/firebase-database.js"></script> <script src="https://www.gstatic.com/firebasejs/8.2.4/firebase-analytics.js"></script> <script> $(".allbtns>img").hide(); var firebaseConfig = { apiKey: "AIzaSyCLURN5izFdrpZj724ltZs-n7POi9BXPRc", authDomain: "classmate-ed6b6.firebaseapp.com", databaseURL: "https://classmate-ed6b6-default-rtdb.firebaseio.com", projectId: "classmate-ed6b6", storageBucket: "classmate-ed6b6.appspot.com", messagingSenderId: "1087720629980", appId: "1:1087720629980:web:ab1b3e600f4eee72ff7619", measurementId: "G-9L68BKBD3T" }; firebase.initializeApp(firebaseConfig); firebase.analytics(); var db = firebase.database(); $("#continuebtn").click(function (e) { e.preventDefault(); var ins = $("#ins")[0].value; var sins = $("#sins")[0].value.toLowerCase(); var dep = $("#dep")[0].value.toLowerCase(); var year = $("#year")[0].value; var ts = $("#ts")[0].value; var fr = $("#fr")[0].value; var lr = $("#lr")[0].value; var ncr = $("#ncr")[0].value; var crrArr = $("#crr")[0].value.split(","); const unique = (value, index, self) => { return self.indexOf(value) === index; } crrArr = crrArr.filter(unique); var ccm = sins + '-' + dep + '-' + year; if (ins == "" || sins == "" || dep == "" || year == "" || ts == "" || fr == "" || lr == "" || ncr == "" || crrArr == "") { fillupFormValidation($("#cbox"), 7000, "Fillup the form"); } else if ((lr - fr + 1) != ts) { fillupFormValidation($("#cbox"), 7000, "Invalid Student orientation"); } else if (filterCRroll(crrArr, lr) != ncr) { fillupFormValidation($("#cbox"), 7000, "Invalid orientation for roll of CR"); } else { db.ref().on("value", function (e) { var j = e.val()[ccm]; if (j == null) { var crr = {}; for (var i = 1; i <= ncr; i++) { crr[i] = crrArr[i - 1]; } for (var i = fr; i <= lr; i++) { db.ref(ccm + "/" + i).set({ password: i.toString() }); } db.ref(ccm + "/cd").set({ ccm: ccm, crr: crr, dep: dep, fr: fr, ins: ins, lr: lr, ncr: ncr, sins: sins, ts: ts, year: year }); console.log("jojo"); $(".allbtns>img").show(); setTimeout(function () { location.replace("registration.html"); }, 4000); } else { setTimeout(function () { location.replace("registration.html"); }, 3000); } }); } }); function filterCRroll(crr, lr) { var Ilr = parseInt(lr); var tempArr = []; var unique1 = []; for (var i = 0; i <= crr.length; i++) { var Icrr = parseInt(crr[i]); if (Icrr <= lr) { tempArr[i] = Icrr; } else { continue; } } return tempArr.length; } function fillupFormValidation(parent, time, notice) { parent.prepend('<p class="alertfillupform" style="background:gray;text-align:center;color:white;">' + notice + '</p>'); $(".alertfillupform").show(); setTimeout(function () { $(".alertfillupform").hide(); $(".alertfillupform").detach(); }, time); } </script> </body> </html>